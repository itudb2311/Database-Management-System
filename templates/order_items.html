<!DOCTYPE html>
<html>
  <head>
    <title>Order Items</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <header
      class="d-flex flex-stratch justify-content-center py-3 mb-4 text-bg-dark fixed-top"
      style="margin-bottom: 6.5rem"
    >
      <a
        href="/"
        class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none"
      >
        <i class="fa-solid fa-table-cells user-icon px-5 fs-1"></i>
        <span class="text-white fs-4">Order Items Table</span>
      </a>

      <ul class="nav nav-pills px-5">
        <li class="nav-item">
          <a href="/" class="nav-link" aria-current="page">Home</a>
        </li>
        <li class="nav-item">
          <a href="/about" class="nav-link">About</a>
        </li>
      </ul>
    </header>

    <div class="container" style="margin-top: 6.5rem">
      <div class="row d-flex" style="justify-content: space-evenly">
        <form id="insert_or_update_form" class="row" action="" method="POST">
          {% for column in centers[1] %}
          <div class="col p-01">
            <label
              class="d-flex justify-content-center fw-bold"
              for="{{ column.column_name }}"
            >
              {{ column.column_name }}
            </label>
            <input type="{{ column.column_type }}" class="form-control" name="{{
            column.column_name }}" id="{{ column.column_name }}" placeholder="{{
            column.column_name }}" {% if "id" in column.column_name %} readonly
            {% endif %} />
          </div>
          {% endfor %}

          <!-- Move the table_name input outside the loop -->
          <input
            type="hidden"
            name="table_name"
            id="table_name"
            value="order_items"
          />

          <div class="col-12 d-flex justify-content-end p-01">
            <button
              type="submit"
              action="update"
              id="update"
              class="btn btn-primary m-2"
              style="width: 100px"
              name="update"
              value="update"
            >
              Update
            </button>
            <button
              type="submit"
              action="insert"
              id="insert"
              class="btn btn-success m-2"
              style="margin-right: 0 !important; width: 100px"
              name="insert"
              value="insert"
            >
              Insert
            </button>
          </div>
        </form>
      </div>
      <div class="row">
        <div class="col-6 d-flex justify-content-start">
          <button
            type="submit"
            class="btn btn-danger m-2"
            style="margin-left: 0px !important; width: 300px"
          >
            Delete Selected Items
          </button>
        </div>
        <div class="col-6 d-flex justify-content-end">
          <button
            type="submit"
            class="btn btn-warning m-2"
            style="margin-right: 0px !important; width: 300px"
          >
            Search
          </button>
        </div>
      </div>
      <div class="row">
        <table
          class="table table-striped table-hover"
          style="margin-top: 1.5rem"
        >
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">ID</th>
              <th scope="col">Order ID</th>
              <th scope="col">User ID</th>
              <th scope="col">Product ID</th>
              <th scope="col">Inventory Item ID</th>
              <th scope="col">Status</th>
              <th scope="col">Created at</th>
              <th scope="col">Shipped at</th>
              <th scope="col">Delivered at</th>
              <th scope="col">Returned at</th>
              <th scope="col">Sale Price</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><i class="fa-solid fa-magnifying-glass"></i></td>
              {% for column in centers[1]%}
              <td>
                <input
                  type="column.column_type"
                  class="form-control"
                  placeholder="Search for {{ column.column_name }}"
                />
              </td>
              {% endfor %}
            </tr>
            {% for center in centers[0] %}
            <tr>
              <th scope="col" nam><input type="checkbox" /></th>
              <td>{{ center[0] }}</td>
              <td>{{ center[1] }}</td>
              <td>{{ center[2] }}</td>
              <td>{{ center[3] }}</td>
              <td>{{ center[4] }}</td>
              <td>{{ center[5] }}</td>
              <td>{{ center[6] }}</td>
              <td>{{ center[7] }}</td>
              <td>{{ center[8] }}</td>
              <td>{{ center[9] }}</td>
              <td>{{ center[10] }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Get all the checkboxes in the table
        var checkboxes = document.querySelectorAll(
          "tbody input[type='checkbox']"
        );
        var selectedItems = []; // Array to store selected items

        // Add click event listener to each checkbox
        checkboxes.forEach(function (checkbox, index) {
          checkbox.addEventListener("change", function () {
            var row = checkbox.closest("tr");

            // Get data from the row containing the clicked checkbox
            var rowData = Array.from(row.children).map(function (cell) {
              return cell.textContent.trim();
            });

            // Check if the checkbox is checked and add/remove from the list accordingly
            if (checkbox.checked) {
              selectedItems.push(rowData);
            } else {
              // Remove the item from the list if the checkbox is unchecked
              var rowIndex = selectedItems.findIndex(
                (item) => JSON.stringify(item) === JSON.stringify(rowData)
              );
              if (rowIndex !== -1) {
                selectedItems.splice(rowIndex, 1);
              }
            }

            // Log the selected items to the console
            console.log("Selected Items:", selectedItems);
          });
        });
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var tableRows = document.querySelectorAll("tbody tr");
        var formInputs = document.querySelectorAll("form input");

        tableRows.forEach(function (row, index) {
          if (index === 0) {
            // Skip first row (contains table headers)
            return;
          }
          row.addEventListener("click", function () {
            // Clear existing values in form inputs
            formInputs.forEach(function (input) {
              input.value = "";
            });

            // Get values from the clicked row
            var columns = row.getElementsByTagName("td");
            for (var i = 0; i < columns.length; i++) {
              formInputs[i].value = columns[i].innerText;
            }
          });
        });
      });
    </script>
    <script>
      function submitForm(actionType, tableName) {
        console.log("Action Type:", actionType);
      
        // Set the value of the table_name input
        document.getElementById("table_name").value = tableName;
      
        // Update the form action based on the actionType
        document.getElementById("insert_or_update_form").action = actionType;
      
        // Submit the form
        document.getElementById("insert_or_update_form").submit();
      }
      document.getElementById("update").addEventListener("click", function (event) {
        event.preventDefault();
        submitForm("update", "order_items");
      });
      
      document.getElementById("insert").addEventListener("click", function (event) {
        event.preventDefault();
        submitForm("insert", "order_items");
      });
    </script>
  </body>
</html>
